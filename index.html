<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabuleiro Interativo com Pergunta</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        #tabuleiro {
            position: relative;
            width: 100vw;
            height: 100vh;
            background-color: #f0f0f0;
            border: 2px solid #000;
        }
        #quadrado {
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: red;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }
        .bolinha {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: blue;
            border-radius: 50%;
        }
        .triangulo {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 30px solid transparent;
            border-right: 30px solid transparent;
            cursor: pointer;
        }
        #triangulo1 {
            border-bottom: 60px solid green;
            left: 20%;
            top: 80%;
        }
        #triangulo2 {
            border-bottom: 60px solid red;
            left: 50%;
            top: 80%;
        }
        #triangulo3 {
            border-bottom: 60px solid yellow;
            left: 80%;
            top: 80%;
        }
    </style>
</head>
<body>
    <div id="tabuleiro">
        <div id="quadrado"></div>
        <div id="triangulo1" class="triangulo"></div>
        <div id="triangulo2" class="triangulo"></div>
        <div id="triangulo3" class="triangulo"></div>
    </div>

    <script>
        const tabuleiro = document.getElementById('tabuleiro');
        const quadrado = document.getElementById('quadrado');
        const bolinhas = [];
        const numBolinhas = 5;
        const triangulo1 = document.getElementById('triangulo1');
        const triangulo2 = document.getElementById('triangulo2');
        const triangulo3 = document.getElementById('triangulo3');

        // Tamanho do tabuleiro
        const larguraTabuleiro = tabuleiro.offsetWidth;
        const alturaTabuleiro = tabuleiro.offsetHeight;

        // Variáveis da multiplicação
        let numero1 = Math.floor(Math.random() * 10) + 1;
        let numero2 = Math.floor(Math.random() * 10) + 1;
        let respostaCorreta = numero1 * numero2;
        let respostasErradas = [respostaCorreta + 5, respostaCorreta - 3, respostaCorreta + 2];
        let bolinhasVelocidade = 2;
        let bolinhasCount = 2;

        // Função para criar bolinhas (agora com velocidades mais altas)
        function criarBolinhas() {
            for (let i = 0; i < bolinhasCount; i++) {
                const bolinha = document.createElement('div');
                bolinha.classList.add('bolinha');
                bolinha.style.left = Math.random() * (larguraTabuleiro - 20) + 'px';
                bolinha.style.top = Math.random() * (alturaTabuleiro - 20) + 'px';
                tabuleiro.appendChild(bolinha);
                bolinhas.push({
                    element: bolinha,
                    velocidadeX: (Math.random() - 0.5) * bolinhasVelocidade,
                    velocidadeY: (Math.random() - 0.5) * bolinhasVelocidade
                });
            }
        }

        // Função para mover o quadrado com o mouse ou toque
        let isTouching = false;
        let touchStartX = 0;
        let touchStartY = 0;

        function moverQuadrado(x, y) {
            let posX = x - quadrado.offsetWidth / 2;
            let posY = y - quadrado.offsetHeight / 2;
            posX = Math.max(0, Math.min(posX, larguraTabuleiro - quadrado.offsetWidth));
            posY = Math.max(0, Math.min(posY, alturaTabuleiro - quadrado.offsetHeight));
            quadrado.style.left = posX + 'px';
            quadrado.style.top = posY + 'px';
        }

        // Detectando o movimento do mouse
        document.addEventListener('mousemove', (event) => {
            if (!isTouching) {
                moverQuadrado(event.clientX, event.clientY);
            }
        });

        // Detectando o toque no dispositivo móvel
        tabuleiro.addEventListener('touchstart', (event) => {
            isTouching = true;
            touchStartX = event.touches[0].clientX;
            touchStartY = event.touches[0].clientY;
        });

        tabuleiro.addEventListener('touchmove', (event) => {
            event.preventDefault(); // Impede o scroll enquanto move o quadrado
            const touchX = event.touches[0].clientX;
            const touchY = event.touches[0].clientY;
            moverQuadrado(touchX, touchY);
        });

        tabuleiro.addEventListener('touchend', () => {
            isTouching = false;
        });

        // Função para atualizar a posição das bolinhas
        function atualizarBolinhas() {
            bolinhas.forEach((bolinha) => {
                const bolinhaRect = bolinha.element.getBoundingClientRect();
                if (bolinhaRect.left <= 0 || bolinhaRect.right >= larguraTabuleiro) {
                    bolinha.velocidadeX *= -1; // Inverte a direção ao bater nas paredes
                    bolinha.velocidadeX += (Math.random() - 0.5) * 2;  // Adiciona variação para o ângulo
                }
                if (bolinhaRect.top <= 0 || bolinhaRect.bottom >= alturaTabuleiro) {
                    bolinha.velocidadeY *= -1; // Inverte a direção ao bater nas paredes
                    bolinha.velocidadeY += (Math.random() - 0.5) * 2;  // Adiciona variação para o ângulo
                }

                bolinha.element.style.left = bolinha.element.offsetLeft + bolinha.velocidadeX + 'px';
                bolinha.element.style.top = bolinha.element.offsetTop + bolinha.velocidadeY + 'px';

                // Verificar colisão com o quadrado
                const quadradoRect = quadrado.getBoundingClientRect();
                if (
                    bolinhaRect.left < quadradoRect.right &&
                    bolinhaRect.right > quadradoRect.left &&
                    bolinhaRect.top < quadradoRect.bottom &&
                    bolinhaRect.bottom > quadradoRect.top
                ) {
                    // Colisão detectada - reiniciar jogo
                    alert('Você encostou em uma bolinha! Recomeçando...');
                    quadrado.style.left = (larguraTabuleiro / 2 - 25) + 'px';
                    quadrado.style.top = (alturaTabuleiro / 2 - 25) + 'px';

                    // Reposicionar bolinhas aleatoriamente
                    bolinhas.forEach((b) => {
                        b.element.style.left = Math.random() * (larguraTabuleiro - 20) + 'px';
                        b.element.style.top = Math.random() * (alturaTabuleiro - 20) + 'px';
                    });
                }
            });

            // Verificar colisão com os triângulos
            verificarColisaoTriangulo(triangulo1, respostasErradas[0]);
            verificarColisaoTriangulo(triangulo2, respostaCorreta);
            verificarColisaoTriangulo(triangulo3, respostasErradas[1]);
        }

        // Função para verificar colisão com os triângulos
        function verificarColisaoTriangulo(triangulo, respostaEsperada) {
            const trianguloRect = triangulo.getBoundingClientRect();
            const quadradoRect = quadrado.getBoundingClientRect();

            if (
                quadradoRect.left < trianguloRect.right &&
                quadradoRect.right > trianguloRect.left &&
                quadradoRect.top < trianguloRect.bottom &&
                quadradoRect.bottom > trianguloRect.top
            ) {
                // Se acertar a resposta correta
                if (respostaEsperada === respostaCorreta) {
                    alert('Você acertou! Recomeçando...');
                    reiniciarJogo();  // Reinicia o jogo se acertar
                } else {
                    alert('Resposta errada, tente novamente!');
                }
            }
        }

        // Função para reiniciar o jogo
        function reiniciarJogo() {
            // Aumenta a quantidade de bolinhas e a velocidade
            if (bolinhasCount < 10) {
                bolinhasCount += 1;
                bolinhasVelocidade += 1;
            }

            // Se atingiu 10 bolinhas, fixa a velocidade
            if (bolinhasCount === 10) {
                bolinhasVelocidade = 10;
            }

            // Atualiza a pergunta com novos números
            numero1 = Math.floor(Math.random() * 10) + 1;
            numero2 = Math.floor(Math.random() * 10) + 1;
            respostaCorreta = numero1 * numero2;
            respostasErradas = [respostaCorreta + 5, respostaCorreta - 3, respostaCorreta + 2];

            // Limpa o tabuleiro e reinicia o jogo
            bolinhas.length = 0;  // Limpa o array de bolinhas
            tabuleiro.innerHTML = '';  // Limpa o tabuleiro
            const quadradoNovo = document.createElement('div');
            quadradoNovo.id = 'quadrado';
            quadradoNovo.style.left = (larguraTabuleiro / 2 - 25) + 'px';
            quadradoNovo.style.top = (alturaTabuleiro / 2 - 25) + 'px';
            tabuleiro.appendChild(quadradoNovo);
            quadrado = quadradoNovo;

            // Recriar bolinhas com novas velocidades
            criarBolinhas();
        }

        // Inicialização
        criarBolinhas();
        setInterval(atualizarBolinhas, 16); // Atualiza a cada frame (aproximadamente 60 FPS)
    </script>
</body>
</html>
